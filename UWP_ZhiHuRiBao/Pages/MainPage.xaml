<common:PageBase
    x:Class="Brook.ZhiHuRiBao.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Brook.ZhiHuRiBao.Pages"
    xmlns:ui="using:CN.Brook.UI"
    xmlns:common="using:Brook.ZhiHuRiBao.Common"
    xmlns:utils="using:Brook.ZhiHuRiBao.Utils"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    mc:Ignorable="d">
    <Page.DataContext>
        <local:MainViewModel/>
    </Page.DataContext>
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Elements/Story.xaml"/>
                <ResourceDictionary Source="../Elements/Comment.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <CollectionViewSource x:Name="CommentGroup" Source="{x:Bind CommentList, Mode=OneWay}" IsSourceGrouped="True" />
        </ResourceDictionary>
    </Page.Resources>
    <Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState >
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1000"/>
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="MainView.DataContext.Mode" Value="1"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <!--<Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <ui:CustomTitleBar x:Name="TitleBar" Grid.Row="0">
            <Button Content="asf" Click="Button_Click"/>
        </ui:CustomTitleBar>-->
        <SplitView x:Name="MainView" DisplayMode="CompactInline" CompactPaneLength="80">
            <SplitView.Pane>
                <ListView x:Name="CategoryListView" SelectionMode="Single" ItemsSource="{x:Bind MainList}" ItemTemplate="{StaticResource Story}" IsItemClickEnabled="True" ItemClick="MainListView_ItemClick">
                </ListView>
            </SplitView.Pane>
            <RelativePanel>
                <ListView x:Name="MainListView" Width="360" RelativePanel.AlignLeftWithPanel="True" SelectionMode="Single" ItemsSource="{x:Bind MainList}" ItemTemplate="{StaticResource Story}" IsItemClickEnabled="True" ItemClick="MainListView_ItemClick"/>
                <SplitView PanePlacement="Right" DisplayMode="Inline" IsPaneOpen="True" OpenPaneLength="320" CompactPaneLength="0" 
                           RelativePanel.RightOf="MainListView" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignTopWithPanel="True" RelativePanel.AlignRightWithPanel="True" >
                    <SplitView.Pane>
                        <ListView x:Name="CommentListView" Width="320" SelectionMode="Single" ItemsSource="{x:Bind CommentGroup.View}" ItemTemplate="{StaticResource Comment}" 
                                  IsItemClickEnabled="True" ShowsScrollingPlaceholders="True">
                            <ListView.GroupStyle>
                                <GroupStyle HeaderTemplate="{StaticResource CommentHeader}"/>
                            </ListView.GroupStyle>
                        </ListView>
                    </SplitView.Pane>
                    <WebView x:Name="MainContent" utils:WebViewExtend.Content="{Binding HtmlSource}"/>
                </SplitView>
            </RelativePanel>
        </SplitView>
    </Grid>
</common:PageBase>
